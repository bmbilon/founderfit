<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FounderFit Score‚Ñ¢ Survey</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --color-primary: #1f8a70;
            --color-primary-light: #2aaa8a;
            --color-primary-dark: #166b54;
            --color-secondary: #f5f5f5;
            --color-text: #2c3e50;
            --color-text-light: #7f8c8d;
            --color-border: #e0e0e0;
            --color-success: #27ae60;
            --color-warning: #e67e22;
            --color-danger: #c0152f;
            --color-bg-light: #f8f9fa;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.12);
        }

        * { box-sizing: border-box; }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--color-text);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .admin-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            z-index: 1000;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-md);
        }

        .admin-button:hover {
            background: var(--color-primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .admin-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .admin-modal.active {
            display: flex;
        }

        .admin-modal-content {
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            max-width: 500px;
            width: 90%;
            padding: 40px;
            text-align: center;
        }

        .admin-modal-content h2 {
            margin-top: 0;
            color: var(--color-primary);
            font-size: 24px;
        }

        .admin-modal-content input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 20px;
            transition: border-color 0.2s ease;
        }

        .admin-modal-content input:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .admin-modal-content button {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 10px;
        }

        .admin-modal-content button:hover {
            background: var(--color-primary-dark);
        }

        .admin-modal-content button.cancel {
            background: var(--color-secondary);
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }

        .admin-modal-content button.cancel:hover {
            background: var(--color-border);
        }

        .admin-error {
            color: var(--color-danger);
            font-size: 14px;
            margin-bottom: 15px;
        }

        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 2000;
            overflow-y: auto;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-header {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 2001;
        }

        .admin-header h1 {
            margin: 0;
            font-size: 24px;
        }

        .admin-close {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .admin-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .admin-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 30px;
        }

        .admin-section {
            margin-bottom: 50px;
            background: var(--color-bg-light);
            padding: 30px;
            border-radius: 12px;
            border-left: 4px solid var(--color-primary);
        }

        .admin-section h2 {
            margin-top: 0;
            color: var(--color-primary);
            font-size: 20px;
            border-bottom: 2px solid var(--color-border);
            padding-bottom: 15px;
        }

        .admin-section h3 {
            color: var(--color-text);
            font-size: 16px;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .dimension-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .dimension-table th {
            background: var(--color-primary);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
        }

        .dimension-table td {
            padding: 12px;
            border-bottom: 1px solid var(--color-border);
            font-size: 14px;
        }

        .dimension-table tr:last-child td {
            border-bottom: none;
        }

        .dimension-table tr:hover {
            background: var(--color-bg-light);
        }

        .dimension-table .q-id {
            font-weight: 600;
            color: var(--color-primary);
        }

        .score-band {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid var(--color-primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .score-band-range {
            font-weight: 600;
            color: var(--color-primary);
            min-width: 80px;
        }

        .coaching-box {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid var(--color-warning);
        }

        .coaching-box strong {
            color: var(--color-warning);
        }

        .header {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
            color: white;
            padding: 50px 30px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            margin: 0 0 8px 0;
            font-size: 32px;
            font-weight: 700;
            letter-spacing: -0.5px;
            position: relative;
            z-index: 1;
        }

        .header p {
            margin: 8px 0;
            font-size: 15px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.25);
            margin-top: 25px;
            border-radius: 3px;
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%);
            width: 0%;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 3px;
        }

        .progress-text {
            font-size: 13px;
            margin-top: 12px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
            font-weight: 500;
        }

        .content {
            padding: 50px 40px;
        }

        .question-container {
            margin-bottom: 40px;
            display: none;
        }

        .question-container.active {
            display: block;
            animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(12px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .question-number {
            font-size: 12px;
            color: var(--color-text-light);
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .question-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .question-type {
            font-size: 12px;
            color: var(--color-text-light);
            font-style: italic;
            margin-bottom: 20px;
        }

        .option {
            background: white;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: flex-start;
        }

        .option:hover {
            border-color: var(--color-primary);
            background: rgba(31, 138, 112, 0.05);
        }

        .option.selected {
            border-color: var(--color-primary);
            background: rgba(31, 138, 112, 0.1);
            font-weight: 600;
        }

        .option input[type="radio"] {
            margin-right: 12px;
            margin-top: 2px;
            cursor: pointer;
            accent-color: var(--color-primary);
            flex-shrink: 0;
        }

        .option-text {
            flex: 1;
        }

        .likert-scale {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 20px;
        }

        .likert-option {
            text-align: center;
        }

        .likert-option input[type="radio"] {
            display: none;
        }

        .likert-label {
            display: block;
            padding: 12px 8px;
            border: 2px solid var(--color-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 500;
            background: white;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            word-break: break-word;
            line-height: 1.3;
        }

        .likert-option input[type="radio"]:checked + .likert-label {
            border-color: var(--color-primary);
            background: rgba(31, 138, 112, 0.1);
            color: var(--color-primary);
            font-weight: 600;
        }

        .likert-label:hover {
            border-color: var(--color-primary);
            background: rgba(31, 138, 112, 0.05);
        }

        .likert-legend {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 8px;
            font-size: 11px;
            color: var(--color-text-light);
            font-style: italic;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            justify-content: space-between;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-prev {
            background: var(--color-secondary);
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }

        .btn-prev:hover:not(:disabled) {
            background: var(--color-border);
        }

        .btn-prev:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-next {
            background: var(--color-primary);
            color: white;
            flex: 1;
        }

        .btn-next:hover {
            background: var(--color-primary-light);
        }

        .btn-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .email-collection-container {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .email-collection-container.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .email-form {
            max-width: 500px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--color-text);
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .btn-submit-email {
            width: 100%;
            padding: 14px 24px;
            background: var(--color-primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            margin-top: 10px;
        }

        .btn-submit-email:hover {
            background: var(--color-primary-dark);
        }

        .privacy-note {
            font-size: 12px;
            color: var(--color-text-light);
            margin-top: 12px;
            font-style: italic;
        }

        .results-container {
            display: none;
            text-align: center;
        }

        .results-container.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .score-display {
            font-size: 64px;
            font-weight: 700;
            color: var(--color-primary);
            margin: 20px 0;
        }

        .score-interpretation {
            font-size: 16px;
            color: var(--color-text);
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .dimension-scores {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 30px;
            text-align: left;
        }

        .dimension-item {
            background: var(--color-secondary);
            padding: 16px;
            border-radius: 8px;
            border-left: 4px solid var(--color-primary);
        }

        .dimension-name {
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: 8px;
        }

        .dimension-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--color-primary);
        }

        .btn-reset {
            background: var(--color-secondary);
            color: var(--color-text);
            border: 1px solid var(--color-border);
            margin-top: 20px;
        }

        .btn-reset:hover {
            background: var(--color-border);
        }

        @media (max-width: 768px) {
            .header { padding: 30px 20px; }
            .header h1 { font-size: 22px; }
            .content { padding: 20px; }
            .dimension-scores { grid-template-columns: 1fr; }
            .button-group { flex-direction: column; }
            .btn-prev { order: 2; }
            .btn-next { order: 1; }
            .likert-scale { grid-template-columns: repeat(5, 1fr); gap: 4px; }
            .likert-label { padding: 8px 2px; font-size: 10px; min-height: 80px; }
            .option { flex-direction: column; }
            .option input[type="radio"] { margin-right: 0; margin-bottom: 8px; }
            .admin-button { top: 10px; right: 10px; padding: 8px 12px; font-size: 12px; }
        }
    </style>
</head>
<body>
    <button class="admin-button" onclick="openAdminLogin()">üîê Admin</button>

    <div class="admin-modal" id="admin-login-modal">
        <div class="admin-modal-content">
            <h2>Administrator Access</h2>
            <div class="admin-error" id="admin-error" style="display: none;"></div>
            <input type="password" id="admin-password" placeholder="Enter password" onkeypress="if(event.key==='Enter') checkAdminPassword()">
            <div style="text-align: right;">
                <button class="cancel" onclick="closeAdminLogin()">Cancel</button>
                <button onclick="checkAdminPassword()">Login</button>
            </div>
        </div>
    </div>

    <div class="admin-panel" id="admin-panel">
        <div class="admin-header">
            <h1>Administrator Panel - FounderFit Score‚Ñ¢ v2.1</h1>
            <button class="admin-close" onclick="closeAdminPanel()">Close</button>
        </div>
        <div class="admin-content">
            <div class="admin-section">
                <h2>üìä Survey Overview</h2>
                <p><strong>Total Questions:</strong> 22</p>
                <p><strong>Question Types:</strong> Binary choices (12) + Likert scale 1-5 (10)</p>
                <p><strong>Dimensions Assessed:</strong> 6 key founder personality traits</p>
                <p><strong>Scoring Method:</strong> Dimension averages converted to 0-100 scale, then overall average</p>
            </div>

            <div class="admin-section">
                <h2>üìã Dimensions & Questions Breakdown</h2>
                
                <h3>Dimension 1: Openness (5 questions)</h3>
                <p><em>Measures willingness to explore new ideas, challenge conventions, and embrace experimentation.</em></p>
                <table class="dimension-table">
                    <thead>
                        <tr>
                            <th>Q#</th>
                            <th>ID</th>
                            <th>Question</th>
                            <th>Type</th>
                            <th>Answer Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td class="q-id">A1</td>
                            <td>Novel market opportunity vs. strategic fit</td>
                            <td>Binary</td>
                            <td>0 = Strategic, 1 = Exploratory</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td class="q-id">A2</td>
                            <td>Product development approach</td>
                            <td>Binary</td>
                            <td>0 = Data-driven, 1 = Experimental</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td class="q-id">A3</td>
                            <td>Industry conventions</td>
                            <td>Binary</td>
                            <td>0 = Respectful, 1 = Challenging</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td class="q-id">A4</td>
                            <td>Learning new technology</td>
                            <td>Binary</td>
                            <td>0 = Foundational, 1 = Hands-on</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td class="q-id">A5</td>
                            <td>Decisions with incomplete information</td>
                            <td>Likert</td>
                            <td>1 = Cautious, 5 = Confident</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Scoring:</strong> Average of all 5 responses, scaled to 0-100</p>

                <h3>Dimension 2: Conscientiousness (3 questions)</h3>
                <p><em>Measures attention to detail, follow-through, and operational rigor as the business scales.</em></p>
                <table class="dimension-table">
                    <thead>
                        <tr>
                            <th>Q#</th>
                            <th>ID</th>
                            <th>Question</th>
                            <th>Type</th>
                            <th>Answer Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>6</td>
                            <td class="q-id">BCONS1</td>
                            <td>Complex project management</td>
                            <td>Binary</td>
                            <td>0 = Vision-focused, 1 = Detail-oriented</td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td class="q-id">BCONS2</td>
                            <td>Operational tasks at scale</td>
                            <td>Binary</td>
                            <td>0 = Delegating, 1 = Hands-on</td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td class="q-id">BCONS3</td>
                            <td>Project commitment vs. new opportunity</td>
                            <td>Likert</td>
                            <td>1 = Abandon easily, 5 = Complete regardless</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Scoring:</strong> Average of all 3 responses, scaled to 0-100</p>

                <h3>Dimension 3: Energy & Drive (4 questions)</h3>
                <p><em>Measures resilience, ambition, goal orientation, and ability to rally teams.</em></p>
                <table class="dimension-table">
                    <thead>
                        <tr>
                            <th>Q#</th>
                            <th>ID</th>
                            <th>Question</th>
                            <th>Type</th>
                            <th>Answer Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>9</td>
                            <td class="q-id">C1</td>
                            <td>Response to major setback</td>
                            <td>Binary</td>
                            <td>0 = Reflective, 1 = Rapid pivot</td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td class="q-id">C2</td>
                            <td>Approach to growth targets</td>
                            <td>Binary</td>
                            <td>0 = Realistic, 1 = Audacious</td>
                        </tr>
                        <tr>
                            <td>11</td>
                            <td class="q-id">C3</td>
                            <td>Team leadership style</td>
                            <td>Binary</td>
                            <td>0 = One-on-one, 1 = Vision-rallying</td>
                        </tr>
                        <tr>
                            <td>12</td>
                            <td class="q-id">C4</td>
                            <td>Multi-year goal commitment</td>
                            <td>Likert</td>
                            <td>1 = Abandons easily, 5 = Obsessive</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Scoring:</strong> Average of all 4 responses, scaled to 0-100</p>

                <h3>Dimension 4: Conviction (3 questions)</h3>
                <p><em>Measures confidence in strategic direction, defensibility of thesis, and resistance to influence.</em></p>
                <table class="dimension-table">
                    <thead>
                        <tr>
                            <th>Q#</th>
                            <th>ID</th>
                            <th>Question</th>
                            <th>Type</th>
                            <th>Answer Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>13</td>
                            <td class="q-id">DCONV1</td>
                            <td>Disagreement with team/investors</td>
                            <td>Binary</td>
                            <td>0 = Open to adjustment, 1 = Confident defense</td>
                        </tr>
                        <tr>
                            <td>14</td>
                            <td class="q-id">DCONV2</td>
                            <td>Strategy challenged/questioned</td>
                            <td>Binary</td>
                            <td>0 = Open to learning, 1 = Defend thesis</td>
                        </tr>
                        <tr>
                            <td>15</td>
                            <td class="q-id">DCONV3</td>
                            <td>Establish strategic direction</td>
                            <td>Likert</td>
                            <td>1 = Market-reactive, 5 = Vision-driven</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Scoring:</strong> Average of all 3 responses, scaled to 0-100</p>

                <h3>Dimension 5: Emotional Stability (3 questions)</h3>
                <p><em>Measures composure under pressure, stress management, and decision confidence despite uncertainty.</em></p>
                <table class="dimension-table">
                    <thead>
                        <tr>
                            <th>Q#</th>
                            <th>ID</th>
                            <th>Question</th>
                            <th>Type</th>
                            <th>Answer Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>16</td>
                            <td class="q-id">E1</td>
                            <td>Multiple simultaneous crises</td>
                            <td>Binary</td>
                            <td>0 = Deliberate pauses, 1 = Ruthless prioritization</td>
                        </tr>
                        <tr>
                            <td>17</td>
                            <td class="q-id">E2</td>
                            <td>Self-doubt in decisions</td>
                            <td>Binary</td>
                            <td>0 = Seeks validation, 1 = Moves confidently</td>
                        </tr>
                        <tr>
                            <td>18</td>
                            <td class="q-id">E3</td>
                            <td>Performance under pressure</td>
                            <td>Likert</td>
                            <td>1 = Visibly stressed, 5 = Calm & deliberate</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Scoring:</strong> Average of all 3 responses, scaled to 0-100</p>

                <h3>Dimension 6: Skepticism & Adaptability (4 questions)</h3>
                <p><em>Measures independent thinking, resistance to groupthink, and willingness to pivot based on data.</em></p>
                <table class="dimension-table">
                    <thead>
                        <tr>
                            <th>Q#</th>
                            <th>ID</th>
                            <th>Question</th>
                            <th>Type</th>
                            <th>Answer Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>19</td>
                            <td class="q-id">F1</td>
                            <td>Experienced advisor suggestions</td>
                            <td>Binary</td>
                            <td>0 = Weight track record, 1 = Test independently</td>
                        </tr>
                        <tr>
                            <td>20</td>
                            <td class="q-id">F2</td>
                            <td>View differs from group consensus</td>
                            <td>Binary</td>
                            <td>0 = Shift to align, 1 = Articulate & defend</td>
                        </tr>
                        <tr>
                            <td>21</td>
                            <td class="q-id">F3</td>
                            <td>Established industry approaches</td>
                            <td>Likert</td>
                            <td>1 = Follow as written, 5 = Reinvent</td>
                        </tr>
                        <tr>
                            <td>22</td>
                            <td class="q-id">F4</td>
                            <td>Data shows strategy needs to shift</td>
                            <td>Binary</td>
                            <td>0 = Analyze thoroughly, 1 = Adjust promptly</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Scoring:</strong> Average of all 4 responses, scaled to 0-100</p>
            </div>

            <div class="admin-section">
                <h2>üéØ Overall Score Calculation</h2>
                <p><strong>Final FounderFit Score</strong> = Average of all 6 dimension scores (0-100 scale)</p>
                <h3>Score Interpretation Bands:</h3>
                <div class="score-band">
                    <div class="score-band-range">80-100</div>
                    <div>Founder personality strongly aligned with success indicators. Your profile suggests high potential for building and scaling ventures.</div>
                </div>
                <div class="score-band">
                    <div class="score-band-range">65-79</div>
                    <div>Above-average alignment with founder success profile. You demonstrate strong entrepreneurial characteristics with room for development.</div>
                </div>
                <div class="score-band">
                    <div class="score-band-range">50-64</div>
                    <div>Average alignment with founder success profile. You have solid foundational traits with opportunities to strengthen key areas.</div>
                </div>
                <div class="score-band">
                    <div class="score-band-range">0-49</div>
                    <div>Below-average alignment with founder success profile. Consider how you might develop key entrepreneurial characteristics.</div>
                </div>
            </div>

            <div class="admin-section">
                <h2>üî¢ Answer Key & Scoring Logic</h2>
                <h3>Binary Questions (0 or 1)</h3>
                <ul>
                    <li>Both answers are valid responses</li>
                    <li><strong>Scoring:</strong> Value / 5 √ó 100 to normalize to 0-100 scale
                        <ul>
                            <li>Answer = 0 ‚Üí contributes 0 points</li>
                            <li>Answer = 1 ‚Üí contributes 20 points</li>
                        </ul>
                    </li>
                </ul>

                <h3>Likert Questions (1-5)</h3>
                <ul>
                    <li><strong>Scoring:</strong> (Value - 1) / 4 √ó 100 to normalize to 0-100 scale
                        <ul>
                            <li>Answer = 1 ‚Üí 0 points</li>
                            <li>Answer = 2 ‚Üí 25 points</li>
                            <li>Answer = 3 ‚Üí 50 points</li>
                            <li>Answer = 4 ‚Üí 75 points</li>
                            <li>Answer = 5 ‚Üí 100 points</li>
                        </ul>
                    </li>
                </ul>

                <h3>Dimension Calculation</h3>
                <ul>
                    <li>Average all responses within a dimension</li>
                    <li>Convert to 0-100 scale using same normalization</li>
                    <li>Round to nearest integer</li>
                </ul>

                <h3>Overall Score Calculation</h3>
                <ul>
                    <li>Calculate all 6 dimension scores (0-100)</li>
                    <li>Average the 6 dimension scores</li>
                    <li>Round to nearest integer</li>
                    <li>Apply interpretation band</li>
                </ul>
            </div>

            <div class="admin-section">
                <h2>üí° Coaching Implications by Dimension</h2>
                
                <h3>Openness</h3>
                <div class="coaching-box">
                    <strong>High Openness (70+):</strong> Explorer, experimentalist‚Äîconsider adding structure and validation gates
                </div>
                <div class="coaching-box">
                    <strong>Low Openness (<40):</strong> Executor, validator‚Äîconsider more rapid prototyping and market testing
                </div>

                <h3>Conscientiousness</h3>
                <div class="coaching-box">
                    <strong>High Conscientiousness (70+):</strong> Detail-oriented‚Äîleverage for operational excellence and documentation
                </div>
                <div class="coaching-box">
                    <strong>Low Conscientiousness (<40):</strong> Visionary‚Äîpair with detail-oriented COO or operations lead
                </div>

                <h3>Energy & Drive</h3>
                <div class="coaching-box">
                    <strong>High Energy & Drive (70+):</strong> Unstoppable force‚Äîchannel toward long-term vision; manage burnout
                </div>
                <div class="coaching-box">
                    <strong>Low Energy & Drive (<40):</strong> Measured approach‚Äîfocus on sustainable scaling and team leverage
                </div>

                <h3>Conviction</h3>
                <div class="coaching-box">
                    <strong>High Conviction (70+):</strong> Visionary leader‚Äîvalidate thesis regularly to avoid sunk-cost bias
                </div>
                <div class="coaching-box">
                    <strong>Low Conviction (<40):</strong> Adaptable‚Äîensure strategic clarity and long-term direction commitment
                </div>

                <h3>Emotional Stability</h3>
                <div class="coaching-box">
                    <strong>High Emotional Stability (70+):</strong> Unflappable‚Äîyour calm is an asset; ensure team feels heard under pressure
                </div>
                <div class="coaching-box">
                    <strong>Low Emotional Stability (<40):</strong> Feeler‚Äîleverage this sensitivity for team dynamics; manage decision anxiety
                </div>

                <h3>Skepticism & Adaptability</h3>
                <div class="coaching-box">
                    <strong>High Skepticism & Adaptability (70+):</strong> Independent thinker‚Äîbalance with team alignment and consistency
                </div>
                <div class="coaching-box">
                    <strong>Low Skepticism & Adaptability (<40):</strong> Loyal executor‚Äîensure you're not accepting flawed advice; test assumptions
                </div>
            </div>

            <div class="admin-section">
                <h2>üìå Key Notes for Administrators</h2>
                <ul>
                    <li><strong>No wrong answers</strong> - The survey measures personality tendencies, not competence</li>
                    <li><strong>Dimension independence</strong> - Each dimension is independent; high scores in one don't require high scores in others</li>
                    <li><strong>Interpretation context</strong> - Score bands are relative; consider individual dimension profiles for nuanced coaching</li>
                    <li><strong>Response validation</strong> - All questions require an answer before proceeding</li>
                    <li><strong>Dimension profiles matter as much as overall score</strong> - a founder with low Openness but high Conviction may be validating an existing thesis effectively</li>
                </ul>
            </div>

            <div class="admin-section" id="reports-section">
                <h2>üìã Test Reports</h2>
                <p><em>View all completed assessments with detailed clinical analysis</em></p>
                <div id="reports-list" style="margin-top: 20px;">
                    <p style="text-align: center; color: #666;">Loading reports...</p>
                </div>
                <div id="report-detail" style="display: none; margin-top: 30px;"></div>
            </div>
        </div>
    </div>

    <div class="container" id="survey-container">
        <div class="header">
            <h1>FounderFit Score‚Ñ¢ v2.1</h1>
            <p>Founder Personality Assessment</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <div class="progress-text"><span class="current-question">0</span> of <span class="total-questions">22</span></div>
        </div>

        <div class="content">
            <div id="questions-container"></div>
            
            <div class="email-collection-container" id="email-section">
                <h2>Get Your Results</h2>
                <p style="color: var(--color-text-light); margin-bottom: 30px;">Enter your information to receive your detailed FounderFit Score‚Ñ¢ analysis via email.</p>
                
                <div class="email-form">
                    <div class="form-group">
                        <label for="user-name">Full Name</label>
                        <input type="text" id="user-name" placeholder="John Doe" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="user-email">Email Address</label>
                        <input type="email" id="user-email" placeholder="john@example.com" required>
                    </div>
                    
                    <button class="btn-submit-email" onclick="submitEmailAndShowResults()">View My Results</button>
                    <p class="privacy-note">We'll only use your email to send your results. No spam, ever.</p>
                </div>
            </div>

            <div class="results-container" id="results-section">
                <h2>Your FounderFit Score</h2>
                <div class="score-display" id="final-score">0</div>
                <div class="score-interpretation" id="score-text"></div>
                
                <h3 style="margin-top: 30px; color: var(--color-primary);">Dimension Breakdown</h3>
                <div class="dimension-scores" id="dimension-results"></div>
                
                <button class="btn-reset" onclick="resetSurvey()">Start Over</button>
            </div>

            <div class="button-group" id="button-group">
                <button class="btn-prev" id="btn-prev" onclick="previousQuestion()" disabled>‚Üê Previous</button>
                <button class="btn-next" id="btn-next" onclick="nextQuestion()" disabled>Next ‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize Supabase
        const SUPABASE_URL = 'https://lcdcwtisiojbtsysjeic.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxjZGN3dGlzaW9qYnRzeXNqZWljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY0Mzg5NzAsImV4cCI6MjA1MjAxNDk3MH0.Onk69BuaVBHN9F9wV__W-g_DOa9klgM';
        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        const questions = [
            {
                id: 'A1',
                dimension: 'Openness',
                text: 'You discover a novel market opportunity that excites you, but it conflicts with your current strategic direction. What do you do?',
                type: 'binary',
                options: [
                    { text: 'I evaluate strategic fit first, but remain open if the opportunity is compelling.', value: 0 },
                    { text: 'I immediately explore it, even if it conflicts with current strategy.', value: 1 }
                ]
            },
            {
                id: 'A2',
                dimension: 'Openness',
                text: 'How do you approach product development and improvements?',
                type: 'binary',
                options: [
                    { text: 'I follow data-driven processes to ensure improvements are sustainable and measurable.', value: 0 },
                    { text: 'I balance experimentation with user insights to drive unexpected innovations.', value: 1 }
                ]
            },
            {
                id: 'A3',
                dimension: 'Openness',
                text: 'When you encounter established industry conventions, what\'s your instinct?',
                type: 'binary',
                options: [
                    { text: 'I respect established practices and propose changes thoughtfully when evidence supports them.', value: 0 },
                    { text: 'I frequently challenge assumptions and explore alternative approaches when I see potential.', value: 1 }
                ]
            },
            {
                id: 'A4',
                dimension: 'Openness',
                text: 'When learning a new technology or tool, how do you approach it?',
                type: 'binary',
                options: [
                    { text: 'I build foundational understanding before diving into implementation.', value: 0 },
                    { text: 'I dive in hands-on and learn through exploration and iteration.', value: 1 }
                ]
            },
            {
                id: 'A5',
                dimension: 'Openness',
                text: 'When facing decisions with incomplete information, how comfortable are you moving forward?',
                type: 'likert',
                options: [
                    { text: 'Prefer to gather additional information before deciding', value: 1 },
                    { text: 'Mostly cautious but willing to move forward', value: 2 },
                    { text: 'Neutral', value: 3 },
                    { text: 'Generally comfortable with incomplete info', value: 4 },
                    { text: 'Move forward confidently with the information available', value: 5 }
                ]
            },
            {
                id: 'BCONS1',
                dimension: 'Conscientiousness',
                text: 'When managing complex projects with many dependencies, what\'s your approach?',
                type: 'binary',
                options: [
                    { text: 'I focus on vision and outcomes; I trust my team with execution oversight.', value: 0 },
                    { text: 'I create detailed timelines and track dependencies to ensure alignment.', value: 1 }
                ]
            },
            {
                id: 'BCONS2',
                dimension: 'Conscientiousness',
                text: 'As your company scales, how do you handle operational tasks and documentation?',
                type: 'binary',
                options: [
                    { text: 'I delegate operational details to specialists so I can focus on strategy.', value: 0 },
                    { text: 'I personally maintain critical processes and documentation as the company scales.', value: 1 }
                ]
            },
            {
                id: 'BCONS3',
                dimension: 'Conscientiousness',
                text: 'When you\'ve committed to a project, how do you typically handle it if a more exciting opportunity emerges?',
                type: 'likert',
                options: [
                    { text: 'Abandon it to pursue the new opportunity', value: 1 },
                    { text: 'Quickly pivot if the opportunity is compelling', value: 2 },
                    { text: 'Neutral', value: 3 },
                    { text: 'Stay committed but reassess strategically', value: 4 },
                    { text: 'See it through to completion regardless', value: 5 }
                ]
            },
            {
                id: 'C1',
                dimension: 'Energy & Drive',
                text: 'When you experience a major setback, how do you respond?',
                type: 'binary',
                options: [
                    { text: 'I take time to process the setback and rebuild my strategic plan.', value: 0 },
                    { text: 'I quickly assess what went wrong and pivot to the next approach.', value: 1 }
                ]
            },
            {
                id: 'C2',
                dimension: 'Energy & Drive',
                text: 'How do you approach ambitious growth targets?',
                type: 'binary',
                options: [
                    { text: 'I base my targets on objective reality‚ÄîI\'m confident in achieving them; missing them indicates flawed planning.', value: 0 },
                    { text: 'I set audacious, almost irrational goals that excite me; the pursuit matters more than the outcome.', value: 1 }
                ]
            },
            {
                id: 'C3',
                dimension: 'Energy & Drive',
                text: 'How do you prefer to interact with and lead your team?',
                type: 'binary',
                options: [
                    { text: 'I prefer deep one-on-one conversations where I can really understand each person.', value: 0 },
                    { text: 'I lead by rallying the team around compelling vision and direction.', value: 1 }
                ]
            },
            {
                id: 'C4',
                dimension: 'Energy & Drive',
                text: 'When you set a multi-year strategic goal, how do you stay the course?',
                type: 'likert',
                options: [
                    { text: 'I abandon it the moment a distraction appears', value: 1 },
                    { text: 'I pivot constantly based on new information', value: 2 },
                    { text: 'I stay committed but adjust tactically when needed', value: 3 },
                    { text: 'I maintain unwavering focus with minimal deviation', value: 4 },
                    { text: 'I obsess over the goal at the expense of everything else', value: 5 }
                ]
            },
            {
                id: 'DCONV1',
                dimension: 'Conviction',
                text: 'When team members or investors disagree with your direction, what do you do?',
                type: 'binary',
                options: [
                    { text: 'I carefully consider their concerns and adjust my approach if they identify genuine risks.', value: 0 },
                    { text: 'I make my case confidently and work toward alignment on my strategic direction.', value: 1 }
                ]
            },
            {
                id: 'DCONV2',
                dimension: 'Conviction',
                text: 'When your strategy is challenged or questioned, how do you typically respond?',
                type: 'binary',
                options: [
                    { text: 'I\'m open to learning from their perspective and pivot if the evidence warrants it.', value: 0 },
                    { text: 'I view it as an opportunity to defend my thesis and strengthen the strategy.', value: 1 }
                ]
            },
            {
                id: 'DCONV3',
                dimension: 'Conviction',
                text: 'How do you establish your strategic direction?',
                type: 'likert',
                options: [
                    { text: 'By responding to market signals tactically', value: 1 },
                    { text: 'Mostly reactive with some forward planning', value: 2 },
                    { text: 'Neutral', value: 3 },
                    { text: 'Mostly vision-driven with tactical flexibility', value: 4 },
                    { text: 'With a specific long-term vision in mind', value: 5 }
                ]
            },
            {
                id: 'E1',
                dimension: 'Emotional Stability',
                text: 'When facing multiple simultaneous crises, how do you respond?',
                type: 'binary',
                options: [
                    { text: 'I consider and weigh the competing demands and manage stress through deliberate pauses.', value: 0 },
                    { text: 'I prioritize ruthlessly and maintain focus on what matters most.', value: 1 }
                ]
            },
            {
                id: 'E2',
                dimension: 'Emotional Stability',
                text: 'When self-doubt might affect your decisions, what\'s your instinct?',
                type: 'binary',
                options: [
                    { text: 'I frequently pause to validate my thinking or get external perspective.', value: 0 },
                    { text: 'I move forward confidently even with incomplete information.', value: 1 }
                ]
            },
            {
                id: 'E3',
                dimension: 'Emotional Stability',
                text: 'How do you show up under pressure and high stakes?',
                type: 'likert',
                options: [
                    { text: 'Visibly stressed and reactive to events', value: 1 },
                    { text: 'Noticeably affected but still functioning', value: 2 },
                    { text: 'Balanced response to circumstances', value: 3 },
                    { text: 'Mostly composed with focused intensity', value: 4 },
                    { text: 'Calm and deliberate regardless of circumstances', value: 5 }
                ]
            },
            {
                id: 'F1',
                dimension: 'Skepticism & Adaptability',
                text: 'When an experienced advisor suggests a different approach, what do you do?',
                type: 'binary',
                options: [
                    { text: 'I give significant weight to their proven track record.', value: 0 },
                    { text: 'I test the idea independently while valuing their perspective.', value: 1 }
                ]
            },
            {
                id: 'F2',
                dimension: 'Skepticism & Adaptability',
                text: 'When your view differs from group consensus, how do you typically respond?',
                type: 'binary',
                options: [
                    { text: 'I listen carefully and am willing to shift to align with the group.', value: 0 },
                    { text: 'I articulate my position clearly and support it with reasoning.', value: 1 }
                ]
            },
            {
                id: 'F3',
                dimension: 'Skepticism & Adaptability',
                text: 'How do you view established industry approaches and best practices?',
                type: 'likert',
                options: [
                    { text: 'Proven methods worth following as written', value: 1 },
                    { text: 'Mostly sound with minor modifications', value: 2 },
                    { text: 'Neutral; context dependent', value: 3 },
                    { text: 'Good foundations but need significant adaptation', value: 4 },
                    { text: 'Launching points for reinvention', value: 5 }
                ]
            },
            {
                id: 'F4',
                dimension: 'Skepticism & Adaptability',
                text: 'When data shows your strategy needs to shift, how do you respond?',
                type: 'binary',
                options: [
                    { text: 'I analyze thoroughly before making any changes.', value: 0 },
                    { text: 'I adjust direction promptly, even if it requires changing course.', value: 1 }
                ]
            }
        ];

        let currentQuestion = 0;
        let responses = {};

        function openAdminLogin() {
            document.getElementById('admin-login-modal').classList.add('active');
            document.getElementById('admin-password').focus();
            document.getElementById('admin-error').style.display = 'none';
        }

        function closeAdminLogin() {
            document.getElementById('admin-login-modal').classList.remove('active');
            document.getElementById('admin-password').value = '';
            document.getElementById('admin-error').style.display = 'none';
        }

        function checkAdminPassword() {
            const password = document.getElementById('admin-password').value;
            if (password === '1234') {
                closeAdminLogin();
                openAdminPanel();
            } else {
                document.getElementById('admin-error').textContent = 'Incorrect password. Try again.';
                document.getElementById('admin-error').style.display = 'block';
                document.getElementById('admin-password').value = '';
                document.getElementById('admin-password').focus();
            }
        }

        async function openAdminPanel() {
            document.getElementById('admin-panel').classList.add('active');
            document.getElementById('survey-container').style.display = 'none';
            await displayReportsList();
        }

        function closeAdminPanel() {
            document.getElementById('admin-panel').classList.remove('active');
            document.getElementById('survey-container').style.display = 'block';
        }

        function initSurvey() {
            const container = document.getElementById('questions-container');
            questions.forEach((q, idx) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-container';
                questionDiv.id = `question-${idx}`;

                const questionNumber = document.createElement('div');
                questionNumber.className = 'question-number';
                questionNumber.textContent = `Question ${idx + 1}`;

                const questionText = document.createElement('div');
                questionText.className = 'question-text';
                questionText.textContent = q.text;

                const questionType = document.createElement('div');
                questionType.className = 'question-type';
                questionType.textContent = q.type === 'likert' ? 'Likert Scale (1-5)' : 'Choose one';

                questionDiv.appendChild(questionNumber);
                questionDiv.appendChild(questionText);
                questionDiv.appendChild(questionType);

                if (q.type === 'binary') {
                    q.options.forEach(opt => {
                        const label = document.createElement('label');
                        label.className = 'option';
                        const input = document.createElement('input');
                        input.type = 'radio';
                        input.name = `q-${idx}`;
                        input.value = opt.value;
                        input.onchange = () => {
                            responses[q.id] = { dimension: q.dimension, value: parseInt(opt.value), type: q.type };
                            document.querySelectorAll(`#question-${idx} .option`).forEach(o => o.classList.remove('selected'));
                            label.classList.add('selected');
                        };
                        label.appendChild(input);
                        const textSpan = document.createElement('span');
                        textSpan.className = 'option-text';
                        textSpan.textContent = opt.text;
                        label.appendChild(textSpan);
                        questionDiv.appendChild(label);
                    });
                } else {
                    const likertDiv = document.createElement('div');
                    likertDiv.className = 'likert-scale';
                    q.options.forEach((opt, optIdx) => {
                        const optionDiv = document.createElement('div');
                        optionDiv.className = 'likert-option';
                        const input = document.createElement('input');
                        input.type = 'radio';
                        input.name = `q-${idx}`;
                        input.value = opt.value;
                        input.id = `q${idx}-opt${optIdx}`;
                        input.onchange = () => {
                            responses[q.id] = { dimension: q.dimension, value: parseInt(opt.value), type: q.type };
                        };
                        const label = document.createElement('label');
                        label.className = 'likert-label';
                        label.htmlFor = `q${idx}-opt${optIdx}`;
                        label.textContent = opt.text;
                        optionDiv.appendChild(input);
                        optionDiv.appendChild(label);
                        likertDiv.appendChild(optionDiv);
                    });
                    questionDiv.appendChild(likertDiv);

                    const legend = document.createElement('div');
                    legend.className = 'likert-legend';
                    legend.innerHTML = '<div>Disagree</div><div></div><div>Neutral</div><div></div><div>Agree</div>';
                    questionDiv.appendChild(legend);
                }

                container.appendChild(questionDiv);
            });

            document.querySelector('.total-questions').textContent = questions.length;
            showQuestion(0);
        }

        function showQuestion(idx) {
            document.querySelectorAll('.question-container').forEach(q => q.classList.remove('active'));
            document.getElementById(`question-${idx}`).classList.add('active');
            
            const q = questions[idx];
            if (responses[q.id]) {
                const input = document.querySelector(`input[name="q-${idx}"][value="${responses[q.id].value}"]`);
                if (input) input.checked = true;
            }

            currentQuestion = idx;
            document.querySelector('.current-question').textContent = idx + 1;
            document.getElementById('btn-prev').disabled = idx === 0;
            document.getElementById('btn-next').disabled = !responses[q.id];

            const progressPercent = ((idx + 1) / questions.length) * 100;
            document.querySelector('.progress-fill').style.width = progressPercent + '%';

            document.getElementById('button-group').style.display = idx === questions.length ? 'none' : 'flex';
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                showQuestion(currentQuestion + 1);
            } else {
                calculateScore();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                showQuestion(currentQuestion - 1);
            }
        }

        // Store calculated scores globally
        let calculatedOverallScore = 0;
        let calculatedDimensionScores = {};

        function calculateScore() {
            const dimensions = {};
            Object.entries(responses).forEach(([qId, data]) => {
                if (!dimensions[data.dimension]) {
                    dimensions[data.dimension] = [];
                }
                // Normalize scores to 0-100 scale based on question type
                let normalizedScore;
                if (data.type === 'binary') {
                    // Binary: 0-1 ‚Üí multiply by 100
                    normalizedScore = data.value * 100;
                } else {
                    // Likert: 1-5 ‚Üí normalize to 0-100
                    normalizedScore = ((data.value - 1) / 4) * 100;
                }
                dimensions[data.dimension].push(normalizedScore);
            });

            const dimensionScores = {};
            Object.entries(dimensions).forEach(([dim, values]) => {
                const avg = values.reduce((a, b) => a + b, 0) / values.length;
                dimensionScores[dim] = Math.round(avg);
            });

            const overallScore = Math.round(
                Object.values(dimensionScores).reduce((a, b) => a + b, 0) / Object.keys(dimensionScores).length
            );

            // Store scores globally
            calculatedOverallScore = overallScore;
            calculatedDimensionScores = dimensionScores;

            // Show email collection form instead of results
            showEmailForm();
        }

        function showEmailForm() {
            document.querySelectorAll('.question-container').forEach(q => q.classList.remove('active'));
            document.getElementById('email-section').classList.add('active');
            document.getElementById('button-group').style.display = 'none';
        }

        function submitEmailAndShowResults() {
            const name = document.getElementById('user-name').value.trim();
            const email = document.getElementById('user-email').value.trim();

            if (!name || !email) {
                alert('Please enter both your name and email address.');
                return;
            }

            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Please enter a valid email address.');
                return;
            }

            // Store user info and display results
            displayResults(calculatedOverallScore, calculatedDimensionScores, name, email);
        }

        function displayResults(score, dimensionScores, name, email) {
            document.querySelectorAll('.question-container').forEach(q => q.classList.remove('active'));
            document.getElementById('email-section').classList.remove('active');
            document.getElementById('results-section').classList.add('active');
            document.getElementById('button-group').style.display = 'none';

            document.getElementById('final-score').textContent = score;

            let interpretation = '';
            if (score >= 80) {
                interpretation = 'Founder personality strongly aligned with success indicators. Your profile suggests high potential for building and scaling ventures.';
            } else if (score >= 65) {
                interpretation = 'Above-average alignment with founder success profile. You demonstrate strong entrepreneurial characteristics with room for development.';
            } else if (score >= 50) {
                interpretation = 'Average alignment with founder success profile. You have solid foundational traits with opportunities to strengthen key areas.';
            } else {
                interpretation = 'Below-average alignment with founder success profile. Consider how you might develop key entrepreneurial characteristics.';
            }

            document.getElementById('score-text').textContent = interpretation;

            const dimensionResults = document.getElementById('dimension-results');
            dimensionResults.innerHTML = '';
            Object.entries(dimensionScores).forEach(([dim, score]) => {
                const div = document.createElement('div');
                div.className = 'dimension-item';
                div.innerHTML = `<div class="dimension-name">${dim}</div><div class="dimension-value">${score}</div>`;
                dimensionResults.appendChild(div);
            });

            // Save report to Supabase with user info and send email
            saveReportToSupabase(score, dimensionScores, name, email);
        }

        function resetSurvey() {
            currentQuestion = 0;
            responses = {};
            document.getElementById('results-section').classList.remove('active');
            document.getElementById('button-group').style.display = 'flex';
            document.querySelectorAll('input[type="radio"]').forEach(i => i.checked = false);
            document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
            showQuestion(0);
        }

        document.addEventListener('change', () => {
            const q = questions[currentQuestion];
            document.getElementById('btn-next').disabled = !responses[q.id];
        });

        // Report Display Functions
        async function displayReportsList() {
            const reports = await loadAllReports();
            const listContainer = document.getElementById('reports-list');
            const detailContainer = document.getElementById('report-detail');
            
            detailContainer.style.display = 'none';
            
            if (reports.length === 0) {
                listContainer.innerHTML = '<p style="text-align: center; color: #666;">No reports yet. Complete a test to generate your first report.</p>';
                return;
            }
            
            let html = '<div style="display: grid; gap: 15px;">';
            reports.forEach((report, index) => {
                const date = new Date(report.created_at).toLocaleString();
                const scoreColor = report.overall_score >= 80 ? '#27ae60' : report.overall_score >= 65 ? '#2aaa8a' : report.overall_score >= 50 ? '#e67e22' : '#c0152f';
                html += `
                    <div style="background: white; border: 2px solid #e0e0e0; border-radius: 8px; padding: 20px; cursor: pointer; transition: all 0.2s;" 
                         onmouseover="this.style.borderColor='#1f8a70'" 
                         onmouseout="this.style.borderColor='#e0e0e0'" 
                         onclick="viewReportDetail('${report.id}')">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>Report #${reports.length - index}</strong>
                                <div style="font-size: 13px; color: #666; margin-top: 5px;">${date}</div>
                            </div>
                            <div style="font-size: 32px; font-weight: bold; color: ${scoreColor};">${report.overall_score}</div>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            listContainer.innerHTML = html;
        }

        async function viewReportDetail(reportId) {
            const reports = await loadAllReports();
            const report = reports.find(r => r.id === reportId);
            
            if (!report) return;
            
            const detailContainer = document.getElementById('report-detail');
            const listContainer = document.getElementById('reports-list');
            
            listContainer.style.display = 'none';
            detailContainer.style.display = 'block';
            
            // Generate clinical report
            const html = generateClinicalReport(report);
            detailContainer.innerHTML = html;
        }

        function generateClinicalReport(report) {
            const date = new Date(report.created_at).toLocaleString();
            const scoreInterpretation = getScoreInterpretation(report.overall_score);
            
            let html = `
                <button onclick="displayReportsList()" style="background: #1f8a70; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin-bottom: 20px;">‚Üê Back to Reports</button>
                
                <div style="background: white; border: 2px solid #1f8a70; border-radius: 12px; padding: 30px;">
                    <h2 style="margin-top: 0; color: #1f8a70;">Clinical Assessment Report</h2>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 25px;">
                        <p style="margin: 5px 0;"><strong>Report ID:</strong> ${report.id.substring(0, 8)}</p>
                        <p style="margin: 5px 0;"><strong>Date:</strong> ${date}</p>
                        <p style="margin: 5px 0;"><strong>Overall Score:</strong> <span style="font-size: 24px; font-weight: bold; color: #1f8a70;">${report.overall_score}/100</span></p>
                        <p style="margin: 5px 0; font-style: italic;">${scoreInterpretation}</p>
                    </div>
                    
                    <h3 style="color: #1f8a70; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px;">Dimension Analysis</h3>
            `;
            
            // Dimension interpretations
            Object.entries(report.dimension_scores).forEach(([dimension, score]) => {
                const interpretation = getDimensionInterpretation(dimension, score);
                const scoreColor = score >= 70 ? '#27ae60' : score >= 40 ? '#2aaa8a' : '#e67e22';
                html += `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid ${scoreColor};">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #2c3e50;">${dimension}</h4>
                            <span style="font-size: 24px; font-weight: bold; color: ${scoreColor};">${score}</span>
                        </div>
                        <p style="margin: 10px 0 0 0; color: #555; line-height: 1.6;">${interpretation}</p>
                    </div>
                `;
            });
            
            // Identified strengths
            const strengths = Object.entries(report.dimension_scores).filter(([_, score]) => score >= 70);
            if (strengths.length > 0) {
                html += `
                    <h3 style="color: #27ae60; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px; margin-top: 30px;">‚úÖ Identified Strengths</h3>
                    <ul style="line-height: 1.8;">
                `;
                strengths.forEach(([dimension, score]) => {
                    html += `<li><strong>${dimension}</strong> (${score}/100): Strong capacity in this area, represents a leadership asset</li>`;
                });
                html += '</ul>';
            }
            
            // Development areas
            const developmentAreas = Object.entries(report.dimension_scores).filter(([_, score]) => score < 40);
            if (developmentAreas.length > 0) {
                html += `
                    <h3 style="color: #e67e22; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px; margin-top: 30px;">üî∂ Development Areas</h3>
                    <ul style="line-height: 1.8;">
                `;
                developmentAreas.forEach(([dimension, score]) => {
                    html += `<li><strong>${dimension}</strong> (${score}/100): Opportunity for structured development and coaching</li>`;
                });
                html += '</ul>';
            }
            
            // Coaching recommendations
            html += `
                <h3 style="color: #1f8a70; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px; margin-top: 30px;">üìù Coaching Recommendations</h3>
                <div style="background: #fff8e6; border-left: 4px solid #e67e22; padding: 20px; border-radius: 8px;">
            `;
            
            const recommendations = getCoachingRecommendations(report.dimension_scores);
            recommendations.forEach(rec => {
                html += `<p style="margin: 10px 0;"><strong>${rec.dimension}:</strong> ${rec.recommendation}</p>`;
            });
            
            html += '</div></div>';
            
            return html;
        }

        function getScoreInterpretation(score) {
            if (score >= 80) return 'Founder personality strongly aligned with success indicators. High potential for building and scaling ventures.';
            if (score >= 65) return 'Above-average alignment with strong entrepreneurial characteristics. Solid foundation for venture building.';
            if (score >= 50) return 'Average alignment with solid foundational traits. Areas of strength balanced with development opportunities.';
            return 'Below-average alignment. Significant development opportunities identified for coaching focus.';
        }

        function getDimensionInterpretation(dimension, score) {
            const interpretations = {
                'Openness': {
                    high: 'Demonstrates strong exploratory tendencies and comfort with ambiguity. Likely to identify novel opportunities and pivot effectively when needed.',
                    medium: 'Balanced approach between exploration and execution. Can adapt when necessary while maintaining strategic focus.',
                    low: 'Prefers structured execution over exploration. Excels at validating existing theses and following proven methodologies.'
                },
                'Conscientiousness': {
                    high: 'Strong attention to detail and process orientation. Likely to maintain rigorous systems and documentation, ensuring operational excellence.',
                    medium: 'Balances detail orientation with big-picture thinking. Can delegate effectively while maintaining oversight of critical processes.',
                    low: 'Focuses on vision and strategic direction over operational details. Delegates execution effectively but may need support in process management.'
                },
                'Energy & Drive': {
                    high: 'Exceptional work capacity and resilience. Maintains high output and recovers quickly from setbacks. Monitor for burnout risk.',
                    medium: 'Sustainable work pace with good recovery patterns. Balances intensity with self-care and team delegation.',
                    low: 'Measured approach to work intensity. May benefit from energy management strategies and delegation frameworks.'
                },
                'Conviction': {
                    high: 'Strong confidence in strategic direction. Makes decisive commitments and maintains course despite obstacles. Ensure validation mechanisms are in place.',
                    medium: 'Balanced confidence with openness to feedback. Can commit to direction while remaining receptive to market signals.',
                    low: 'Thoughtful and measured in commitments. Seeks validation before major decisions. May benefit from decision-making frameworks.'
                },
                'Emotional Stability': {
                    high: 'Exceptional composure under pressure. Maintains steady leadership presence during uncertainty. Strong asset for team morale.',
                    medium: 'Generally stable with normal stress responses. Manages pressure effectively with appropriate support systems.',
                    low: 'More reactive to stress and uncertainty. May benefit from emotional regulation strategies and leadership coaching.'
                },
                'Skepticism & Adaptability': {
                    high: 'Independent thinker who questions assumptions. Adapts quickly based on evidence. Ensure team alignment on strategic pivots.',
                    medium: 'Balances independent thinking with collaborative decision-making. Open to input while maintaining strategic clarity.',
                    low: 'Values proven approaches and expert guidance. Builds on established frameworks. May need support in rapid adaptation scenarios.'
                }
            };
            
            const dimData = interpretations[dimension];
            if (!dimData) return 'Interpretation not available for this dimension.';
            
            if (score >= 70) return dimData.high;
            if (score >= 40) return dimData.medium;
            return dimData.low;
        }

        function getCoachingRecommendations(dimensionScores) {
            const recommendations = [];
            
            Object.entries(dimensionScores).forEach(([dimension, score]) => {
                let rec = '';
                
                if (dimension === 'Openness') {
                    rec = score >= 70 ? 'Leverage exploratory strength for opportunity identification. Ensure validation frameworks prevent over-pivoting.' :
                          score >= 40 ? 'Maintain balanced approach. Consider structured innovation time to explore adjacent opportunities.' :
                          'Focus on execution excellence. Partner with exploratory thinkers for strategic optionality.';
                } else if (dimension === 'Conscientiousness') {
                    rec = score >= 70 ? 'Leverage process strength for operational excellence. Ensure detail focus doesn\'t slow strategic agility.' :
                          score >= 40 ? 'Continue balanced approach. Document critical processes while maintaining strategic flexibility.' :
                          'Delegate operational details. Build strong COO/operations partner to complement visionary focus.';
                } else if (dimension === 'Energy & Drive') {
                    rec = score >= 70 ? 'Monitor for burnout. Implement recovery protocols and delegation strategies for sustainable scaling.' :
                          score >= 40 ? 'Maintain sustainable pace. Continue current energy management and delegation practices.' :
                          'Develop energy optimization strategies. Focus on high-leverage activities and team empowerment.';
                } else if (dimension === 'Conviction') {
                    rec = score >= 70 ? 'Strong conviction is an asset. Implement regular validation checkpoints to ensure market alignment.' :
                          score >= 40 ? 'Balanced conviction serves you well. Continue integrating feedback while maintaining strategic clarity.' :
                          'Build decision confidence through validation frameworks. Consider advisory board for strategic guidance.';
                } else if (dimension === 'Emotional Stability') {
                    rec = score >= 70 ? 'Leverage composure as leadership strength. Model calm decision-making for team during uncertainty.' :
                          score >= 40 ? 'Continue effective stress management. Maintain support systems for high-pressure periods.' :
                          'Develop emotional regulation strategies. Consider executive coaching for leadership presence development.';
                } else if (dimension === 'Skepticism & Adaptability') {
                    rec = score >= 70 ? 'Independent thinking is valuable. Ensure team alignment when making strategic pivots.' :
                          score >= 40 ? 'Balanced approach serves you well. Continue integrating diverse perspectives in decision-making.' :
                          'Leverage proven frameworks and expert guidance. Build advisory network for strategic validation.';
                }
                
                recommendations.push({ dimension, recommendation: rec });
            });
            
            return recommendations;
        }

        // Supabase Functions
        async function saveReportToSupabase(overallScore, dimensionScores, name, email) {
            try {
                const { data, error } = await supabaseClient
                    .from('test_reports')
                    .insert([
                        {
                            overall_score: overallScore,
                            dimension_scores: dimensionScores,
                            responses: responses,
                            user_name: name,
                            user_email: email
                        }
                    ]);
                
                if (error) {
                    console.error('Error saving report:', error);
                } else {
                    console.log('Report saved successfully');
                    // Send email with results
                    sendResultsEmail(overallScore, dimensionScores, name, email);
                }
            } catch (err) {
                console.error('Error:', err);
            }
        }

        async function sendResultsEmail(overallScore, dimensionScores, name, email) {
            try {
                // Call serverless function to send email
                const response = await fetch('/api/send-email', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name: name,
                        email: email,
                        overallScore: overallScore,
                        dimensionScores: dimensionScores
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    console.log('Email sent successfully to', email);
                } else {
                    console.error('Failed to send email:', data);
                }
            } catch (err) {
                console.error('Error sending email:', err);
            }
        }

        async function loadAllReports() {
            try {
                const { data, error } = await supabaseClient
                    .from('test_reports')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) {
                    console.error('Error loading reports:', error);
                    return [];
                }
                return data;
            } catch (err) {
                console.error('Error:', err);
                return [];
            }
        }

        initSurvey();
    </script>
</body>
</html>
